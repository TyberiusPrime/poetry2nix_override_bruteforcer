{"info":{"author":"Florian Fervers","author_email":"florian.fervers@gmail.com","bugtrack_url":null,"classifiers":["Development Status :: 3 - Alpha","Intended Audience :: Developers","License :: OSI Approved :: MIT License","Programming Language :: Python :: 3"],"description":"# *einx* - Universal Tensor Operations in Einstein-Inspired Notation\n\n[![pytest](https://github.com/fferflo/einx/actions/workflows/run_pytest.yml/badge.svg)](https://github.com/fferflo/einx/actions/workflows/run_pytest.yml)\n[![Documentation](https://img.shields.io/badge/documentation-link-blue.svg)](https://einx.readthedocs.io)\n[![PyPI version](https://badge.fury.io/py/einx.svg)](https://badge.fury.io/py/einx)\n[![Python 3.8+](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/release/python-380/)\n\neinx is a Python library that provides a universal interface to formulate tensor operations in frameworks such as Numpy, PyTorch, Jax and Tensorflow. The design is based on the following principles:\n\n1. **Provide a set of elementary tensor operations** following Numpy-like naming: `einx.{sum|max|where|add|dot|flip|get_at|...}`\n2. **Use einx notation to express vectorization of the elementary operations.** einx notation is inspired by [einops](https://github.com/arogozhnikov/einops), but introduces several novel concepts such as `[]`-bracket notation and full composability that allow using it as a universal language for tensor operations.\n\neinx can be integrated and mixed with existing code seamlessly. All operations are [just-in-time compiled](https://einx.readthedocs.io/en/latest/more/jit.html) into regular Python functions using Python's [exec()](https://docs.python.org/3/library/functions.html#exec) and invoke operations from the respective framework.\n\n**Getting started:**\n\n* [Tutorial](https://einx.readthedocs.io/en/latest/gettingstarted/tutorial_overview.html)\n* [Example: GPT-2 with einx](https://einx.readthedocs.io/en/latest/gettingstarted/gpt2.html)\n* [How is einx different from einops?](https://einx.readthedocs.io/en/latest/faq/einops.html)\n* [How is einx notation universal?](https://einx.readthedocs.io/en/latest/faq/universal.html)\n* [API reference](https://einx.readthedocs.io/en/latest/api.html)\n\n## Installation\n\n```python\npip install einx\n```\n\nSee [Installation](https://einx.readthedocs.io/en/latest/gettingstarted/installation.html) for more information.\n\n## What does einx look like?\n\n#### Tensor manipulation\n\n```python\nimport einx\nx = {np.asarray|torch.as_tensor|jnp.asarray|...}(...) # Create some tensor\n\neinx.sum(\"a [b]\", x)                              # Sum-reduction along second axis\neinx.flip(\"... (g [c])\", x, c=2)                  # Flip pairs of values along the last axis\neinx.mean(\"b [s...] c\", x)                        # Spatial mean-pooling\neinx.sum(\"b (s [s2])... c\", x, s2=2)              # Sum-pooling with kernel_size=stride=2\neinx.add(\"a, b -> a b\", x, y)                     # Outer sum\n\neinx.get_at(\"b [h w] c, b i [2] -> b i c\", x, y)  # Gather values at coordinates\n\neinx.rearrange(\"b (q + k) -> b q, b k\", x, q=2)   # Split\neinx.rearrange(\"b c, 1 -> b (c + 1)\", x, [42])    # Append number to each channel\n\n                                                  # Apply custom operations:\neinx.vmap(\"b [s...] c -> b c\", x, op=np.mean)     # Spatial mean-pooling\neinx.vmap(\"a [b], [b] c -> a c\", x, y, op=np.dot) # Matmul\n```\n\nAll einx functions simply forward computation to the respective backend, e.g. by internally calling `np.reshape`, `np.transpose`, `np.sum` with the appropriate arguments.\n\n#### Common neural network operations\n\n```python\n# Layer normalization\nmean = einx.mean(\"b... [c]\", x, keepdims=True)\nvar = einx.var(\"b... [c]\", x, keepdims=True)\nx = (x - mean) * torch.rsqrt(var + epsilon)\n\n# Prepend class token\neinx.rearrange(\"b s... c, c -> b (1 + (s...)) c\", x, cls_token)\n\n# Multi-head attention\nattn = einx.dot(\"b q (h c), b k (h c) -> b q k h\", q, k, h=8)\nattn = einx.softmax(\"b q [k] h\", attn)\nx = einx.dot(\"b q k h, b k (h c) -> b q (h c)\", attn, v)\n\n# Matmul in linear layers\neinx.dot(\"b...      [c1->c2]\",  x, w)              # - Regular\neinx.dot(\"b...   (g [c1->c2])\", x, w)              # - Grouped: Same weights per group\neinx.dot(\"b... ([g c1->g c2])\", x, w)              # - Grouped: Different weights per group\neinx.dot(\"b  [s...->s2]  c\",    x, w)              # - Spatial mixing as in MLP-mixer\n```\n\nSee [Common neural network ops](https://einx.readthedocs.io/en/latest/gettingstarted/commonnnops.html) for more examples.\n\n#### Optional: Deep learning modules\n\n```python\nimport einx.nn.{torch|flax|haiku|equinox|keras} as einn\n\nbatchnorm       = einn.Norm(\"[b...] c\", decay_rate=0.9)\nlayernorm       = einn.Norm(\"b... [c]\") # as used in transformers\ninstancenorm    = einn.Norm(\"b [s...] c\")\ngroupnorm       = einn.Norm(\"b [s...] (g [c])\", g=8)\nrmsnorm         = einn.Norm(\"b... [c]\", mean=False, bias=False)\n\nchannel_mix     = einn.Linear(\"b... [c1->c2]\", c2=64)\nspatial_mix1    = einn.Linear(\"b [s...->s2] c\", s2=64)\nspatial_mix2    = einn.Linear(\"b [s2->s...] c\", s=(64, 64))\npatch_embed     = einn.Linear(\"b (s [s2->])... [c1->c2]\", s2=4, c2=64)\n\ndropout         = einn.Dropout(\"[...]\",       drop_rate=0.2)\nspatial_dropout = einn.Dropout(\"[b] ... [c]\", drop_rate=0.2)\ndroppath        = einn.Dropout(\"[b] ...\",     drop_rate=0.2)\n```\n\nSee `examples/train_{torch|flax|haiku|equinox|keras}.py` for example trainings on CIFAR10, [GPT-2](https://einx.readthedocs.io/en/latest/gettingstarted/gpt2.html) and [Mamba](https://github.com/fferflo/weightbridge/blob/master/examples/mamba2flax.py) for working example implementations of language models using einx, and [Tutorial: Neural networks](https://einx.readthedocs.io/en/latest/gettingstarted/tutorial_neuralnetworks.html) for more details.\n\n#### Just-in-time compilation\n\neinx traces the required backend operations for a given call into graph representation and just-in-time compiles them into a regular Python function using Python's [`exec()`](https://docs.python.org/3/library/functions.html#exec). This reduces overhead to a single cache lookup and allows inspecting the generated function. For example:\n\n```python\n>>> x = np.zeros((3, 10, 10))\n>>> graph = einx.sum(\"... (g [c])\", x, g=2, graph=True)\n>>> print(graph)\nimport numpy as np\ndef op0(i0):\n    x0 = np.reshape(i0, (3, 10, 2, 5))\n    x1 = np.sum(x0, axis=3)\n    return x1\n```\n\nSee [Just-in-time compilation](https://einx.readthedocs.io/en/latest/more/jit.html) for more details.\n","description_content_type":"text/markdown","docs_url":null,"download_url":null,"downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://github.com/fferflo/einx","keywords":null,"license":"MIT","maintainer":null,"maintainer_email":null,"name":"einx","package_url":"https://pypi.org/project/einx/","platform":null,"project_url":"https://pypi.org/project/einx/","project_urls":{"Homepage":"https://github.com/fferflo/einx"},"provides_extra":null,"release_url":"https://pypi.org/project/einx/0.3.0/","requires_dist":["numpy","sympy","frozendict","keras>=3; extra == \"keras\"","torch>=2; extra == \"torch\""],"requires_python":">=3.8","summary":"Universal Tensor Operations in Einstein-Inspired Notation for Python","version":"0.3.0","yanked":false,"yanked_reason":null},"last_serial":23623708,"releases":{"0.0.1":[{"comment_text":"","digests":{"blake2b_256":"2ad3cd782abd1ffad7018b3721561ec6e6c683f26e30d85b691ec4b564c755f9","md5":"1e18f2838d492fcc5ae3d4a5db496697","sha256":"973447cb412a3b19e729884f190d125d7d409cbc24781dcf00120f77a71ce7f1"},"downloads":-1,"filename":"einx-0.0.1.tar.gz","has_sig":false,"md5_digest":"1e18f2838d492fcc5ae3d4a5db496697","packagetype":"sdist","python_version":"source","requires_python":">=3","size":44635,"upload_time":"2023-12-07T11:42:37","upload_time_iso_8601":"2023-12-07T11:42:37.641741Z","url":"https://files.pythonhosted.org/packages/2a/d3/cd782abd1ffad7018b3721561ec6e6c683f26e30d85b691ec4b564c755f9/einx-0.0.1.tar.gz","yanked":false,"yanked_reason":null}],"0.0.2":[{"comment_text":"","digests":{"blake2b_256":"d6c157769409ce1a846366ea4298e8952e1b256a738f96cf4f9172d003a5f003","md5":"0b1bac0fa1ecee7533f9e94adc9ac460","sha256":"190520e2a8b23d6dd7ae2dda528e7f40e9fe94955b2b0fbb6b88422e61273dd0"},"downloads":-1,"filename":"einx-0.0.2.tar.gz","has_sig":false,"md5_digest":"0b1bac0fa1ecee7533f9e94adc9ac460","packagetype":"sdist","python_version":"source","requires_python":">=3","size":46066,"upload_time":"2023-12-14T14:07:18","upload_time_iso_8601":"2023-12-14T14:07:18.243581Z","url":"https://files.pythonhosted.org/packages/d6/c1/57769409ce1a846366ea4298e8952e1b256a738f96cf4f9172d003a5f003/einx-0.0.2.tar.gz","yanked":false,"yanked_reason":null}],"0.0.3":[{"comment_text":"","digests":{"blake2b_256":"ad4af248d894312ac2dfeb92fbf52a43e5af923ae38efe21f8e0dae1533c5110","md5":"48b298c2e075566222ff17b4dfe2009d","sha256":"8fae6dc7d210e6c49f2060ee0b4ed5ccc9738f1bf3736924d9211222d7474f49"},"downloads":-1,"filename":"einx-0.0.3.tar.gz","has_sig":false,"md5_digest":"48b298c2e075566222ff17b4dfe2009d","packagetype":"sdist","python_version":"source","requires_python":">=3","size":51260,"upload_time":"2023-12-18T14:04:10","upload_time_iso_8601":"2023-12-18T14:04:10.580892Z","url":"https://files.pythonhosted.org/packages/ad/4a/f248d894312ac2dfeb92fbf52a43e5af923ae38efe21f8e0dae1533c5110/einx-0.0.3.tar.gz","yanked":false,"yanked_reason":null}],"0.1.0":[{"comment_text":"","digests":{"blake2b_256":"4d10a5267f46f2eda5b8ac6a0f73dc6d76268329f83170f5e1431bcced65177b","md5":"e6ffb44c1b21cb8696e9de6506a0c881","sha256":"c06289aa0b40d4d3fc9f0240a02fe314ab6b5df546b3175b9c32afb26752e421"},"downloads":-1,"filename":"einx-0.1.0.tar.gz","has_sig":false,"md5_digest":"e6ffb44c1b21cb8696e9de6506a0c881","packagetype":"sdist","python_version":"source","requires_python":">=3","size":54217,"upload_time":"2024-01-17T12:26:57","upload_time_iso_8601":"2024-01-17T12:26:57.139937Z","url":"https://files.pythonhosted.org/packages/4d/10/a5267f46f2eda5b8ac6a0f73dc6d76268329f83170f5e1431bcced65177b/einx-0.1.0.tar.gz","yanked":false,"yanked_reason":null}],"0.1.1":[{"comment_text":"","digests":{"blake2b_256":"451095f5ba340c30ffcb1cf356c8fa5a57665eda4045c4bc1af392fc10594b3a","md5":"b6b96b0243c40459cd26a7121d8b3a58","sha256":"84b834177491b40f6cc7524f269500b62134c2e776aa1467753cbd26107e51ff"},"downloads":-1,"filename":"einx-0.1.1.tar.gz","has_sig":false,"md5_digest":"b6b96b0243c40459cd26a7121d8b3a58","packagetype":"sdist","python_version":"source","requires_python":">=3.8","size":54213,"upload_time":"2024-01-17T13:50:41","upload_time_iso_8601":"2024-01-17T13:50:41.055711Z","url":"https://files.pythonhosted.org/packages/45/10/95f5ba340c30ffcb1cf356c8fa5a57665eda4045c4bc1af392fc10594b3a/einx-0.1.1.tar.gz","yanked":false,"yanked_reason":null}],"0.1.2":[{"comment_text":"","digests":{"blake2b_256":"3b92f1e5ef3da7f794de1e0574ba49537b7124da54f09c9cf8b7a53a086b87cc","md5":"f316b96214914f727d48020ce7b8508f","sha256":"512e70cc818a842d10185ae159a92b9965b5f096a263b01d928c8df55e75126e"},"downloads":-1,"filename":"einx-0.1.2.tar.gz","has_sig":false,"md5_digest":"f316b96214914f727d48020ce7b8508f","packagetype":"sdist","python_version":"source","requires_python":">=3.8","size":59350,"upload_time":"2024-01-27T17:07:38","upload_time_iso_8601":"2024-01-27T17:07:38.225650Z","url":"https://files.pythonhosted.org/packages/3b/92/f1e5ef3da7f794de1e0574ba49537b7124da54f09c9cf8b7a53a086b87cc/einx-0.1.2.tar.gz","yanked":false,"yanked_reason":null}],"0.1.3":[{"comment_text":"","digests":{"blake2b_256":"ecb5fdb2fe8d49bf812b0e3f5ee32c4ae53abe98cb6e7cd5013c7987f0fe36c4","md5":"f4fab75ded1d1509bf0873d7f0692e53","sha256":"b614e6749dfd8dc24eb35c555b4bd7bd7cdf09b2e740943d115fb6cc9d21bded"},"downloads":-1,"filename":"einx-0.1.3-py3-none-any.whl","has_sig":false,"md5_digest":"f4fab75ded1d1509bf0873d7f0692e53","packagetype":"bdist_wheel","python_version":"py3","requires_python":">=3.8","size":87999,"upload_time":"2024-04-04T18:36:57","upload_time_iso_8601":"2024-04-04T18:36:57.659871Z","url":"https://files.pythonhosted.org/packages/ec/b5/fdb2fe8d49bf812b0e3f5ee32c4ae53abe98cb6e7cd5013c7987f0fe36c4/einx-0.1.3-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"14715f57e76b19a5d48d4f8e28202fd6adf742cf52caf7bc1462772c455eea8f","md5":"3d7230f28ea7a3dbd7c4920f7d781693","sha256":"f85d46193246517d5fe3455cf9e5f5e6bf4c7a159864c83b5d20605e8fb8701d"},"downloads":-1,"filename":"einx-0.1.3.tar.gz","has_sig":false,"md5_digest":"3d7230f28ea7a3dbd7c4920f7d781693","packagetype":"sdist","python_version":"source","requires_python":">=3.8","size":64592,"upload_time":"2024-01-28T16:43:14","upload_time_iso_8601":"2024-01-28T16:43:14.075660Z","url":"https://files.pythonhosted.org/packages/14/71/5f57e76b19a5d48d4f8e28202fd6adf742cf52caf7bc1462772c455eea8f/einx-0.1.3.tar.gz","yanked":false,"yanked_reason":null}],"0.2.0":[{"comment_text":"","digests":{"blake2b_256":"9871d1a85e6115e0480dff073b55092d24a4a4e0dc234b9a71960d5dc7d44cbb","md5":"a65dc6a3d8839a30fad656ab424c4378","sha256":"153b2d8a70dd29dc32d2376b44b99d8d528a6b89c5172ac8d97c0f867a870069"},"downloads":-1,"filename":"einx-0.2.0.tar.gz","has_sig":false,"md5_digest":"a65dc6a3d8839a30fad656ab424c4378","packagetype":"sdist","python_version":"source","requires_python":">=3.8","size":71813,"upload_time":"2024-04-04T18:43:27","upload_time_iso_8601":"2024-04-04T18:43:27.662501Z","url":"https://files.pythonhosted.org/packages/98/71/d1a85e6115e0480dff073b55092d24a4a4e0dc234b9a71960d5dc7d44cbb/einx-0.2.0.tar.gz","yanked":false,"yanked_reason":null}],"0.2.1":[{"comment_text":"","digests":{"blake2b_256":"4e42280fe2424e39b5611d017033567a065f79a2eaa43cf02f236aa07ccda448","md5":"ed363288f3b7f670a2e9f1cf47019c69","sha256":"df66c68ab4eaf593b70252eaca34a48a44d711ce7733b4a779ce783387d062dc"},"downloads":-1,"filename":"einx-0.2.1-py3-none-any.whl","has_sig":false,"md5_digest":"ed363288f3b7f670a2e9f1cf47019c69","packagetype":"bdist_wheel","python_version":"py3","requires_python":">=3.8","size":98119,"upload_time":"2024-04-23T19:30:19","upload_time_iso_8601":"2024-04-23T19:30:19.858049Z","url":"https://files.pythonhosted.org/packages/4e/42/280fe2424e39b5611d017033567a065f79a2eaa43cf02f236aa07ccda448/einx-0.2.1-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"261d8b9713ff42423032577b6d886bf7638fc856348ccb21cb2f8c6efe9bbf52","md5":"da59da055a546a35456032851c6e9865","sha256":"d5ebecdf54dc9327d761441c05fb80b8d299f2f425e5d032e627ac2bde61b531"},"downloads":-1,"filename":"einx-0.2.1.tar.gz","has_sig":false,"md5_digest":"da59da055a546a35456032851c6e9865","packagetype":"sdist","python_version":"source","requires_python":">=3.8","size":78717,"upload_time":"2024-04-23T19:30:21","upload_time_iso_8601":"2024-04-23T19:30:21.877729Z","url":"https://files.pythonhosted.org/packages/26/1d/8b9713ff42423032577b6d886bf7638fc856348ccb21cb2f8c6efe9bbf52/einx-0.2.1.tar.gz","yanked":false,"yanked_reason":null}],"0.2.2":[{"comment_text":"","digests":{"blake2b_256":"08b769d8d5a187fa8d86dec7357d63fbd36eaf9cf3f5e62adc169148d569384b","md5":"292e95e2b5793811fb624d83eb98f166","sha256":"bde86f19a60bc8ce3c3aa173c0f1ba59df8d8c0435c4b61638499c3d187dd28b"},"downloads":-1,"filename":"einx-0.2.2-py3-none-any.whl","has_sig":false,"md5_digest":"292e95e2b5793811fb624d83eb98f166","packagetype":"bdist_wheel","python_version":"py3","requires_python":">=3.8","size":101569,"upload_time":"2024-04-26T09:50:26","upload_time_iso_8601":"2024-04-26T09:50:26.366204Z","url":"https://files.pythonhosted.org/packages/08/b7/69d8d5a187fa8d86dec7357d63fbd36eaf9cf3f5e62adc169148d569384b/einx-0.2.2-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"96a03fa2f5593b2537bd6fd4e786c4996ef3ace61c7e5bf89aa7b4b591bdbb57","md5":"e97a6ccce4d66a96d80417be7acc05c4","sha256":"79f4ff77c07370c490535338365ed7b417c6d0e86e893584d50bd3fde46c62e8"},"downloads":-1,"filename":"einx-0.2.2.tar.gz","has_sig":false,"md5_digest":"e97a6ccce4d66a96d80417be7acc05c4","packagetype":"sdist","python_version":"source","requires_python":">=3.8","size":81991,"upload_time":"2024-04-26T09:50:27","upload_time_iso_8601":"2024-04-26T09:50:27.597428Z","url":"https://files.pythonhosted.org/packages/96/a0/3fa2f5593b2537bd6fd4e786c4996ef3ace61c7e5bf89aa7b4b591bdbb57/einx-0.2.2.tar.gz","yanked":false,"yanked_reason":null}],"0.3.0":[{"comment_text":"","digests":{"blake2b_256":"90044a730d74fd908daad86d6b313f235cdf8e0cf1c255b392b7174ff63ea81a","md5":"b39e9fe21fd0829d6514f9fcc54b8920","sha256":"367d62bab8dbb8c4937308512abb6f746cc0920990589892ba0d281356d39345"},"downloads":-1,"filename":"einx-0.3.0-py3-none-any.whl","has_sig":false,"md5_digest":"b39e9fe21fd0829d6514f9fcc54b8920","packagetype":"bdist_wheel","python_version":"py3","requires_python":">=3.8","size":102958,"upload_time":"2024-06-11T13:49:36","upload_time_iso_8601":"2024-06-11T13:49:36.441686Z","url":"https://files.pythonhosted.org/packages/90/04/4a730d74fd908daad86d6b313f235cdf8e0cf1c255b392b7174ff63ea81a/einx-0.3.0-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"95af2a2f83f981e969ae3ec5dc30f9b0cd1a258acabc2ff7b33eb9726e334e55","md5":"86954b3b50240ab25ba6f891cd9fc310","sha256":"17ff87c6a0f68ab358c1da489f00e95f1de106fd12ff17d0fb3e210aaa1e5f8c"},"downloads":-1,"filename":"einx-0.3.0.tar.gz","has_sig":false,"md5_digest":"86954b3b50240ab25ba6f891cd9fc310","packagetype":"sdist","python_version":"source","requires_python":">=3.8","size":84758,"upload_time":"2024-06-11T13:49:37","upload_time_iso_8601":"2024-06-11T13:49:37.532515Z","url":"https://files.pythonhosted.org/packages/95/af/2a2f83f981e969ae3ec5dc30f9b0cd1a258acabc2ff7b33eb9726e334e55/einx-0.3.0.tar.gz","yanked":false,"yanked_reason":null}]},"urls":[{"comment_text":"","digests":{"blake2b_256":"90044a730d74fd908daad86d6b313f235cdf8e0cf1c255b392b7174ff63ea81a","md5":"b39e9fe21fd0829d6514f9fcc54b8920","sha256":"367d62bab8dbb8c4937308512abb6f746cc0920990589892ba0d281356d39345"},"downloads":-1,"filename":"einx-0.3.0-py3-none-any.whl","has_sig":false,"md5_digest":"b39e9fe21fd0829d6514f9fcc54b8920","packagetype":"bdist_wheel","python_version":"py3","requires_python":">=3.8","size":102958,"upload_time":"2024-06-11T13:49:36","upload_time_iso_8601":"2024-06-11T13:49:36.441686Z","url":"https://files.pythonhosted.org/packages/90/04/4a730d74fd908daad86d6b313f235cdf8e0cf1c255b392b7174ff63ea81a/einx-0.3.0-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"95af2a2f83f981e969ae3ec5dc30f9b0cd1a258acabc2ff7b33eb9726e334e55","md5":"86954b3b50240ab25ba6f891cd9fc310","sha256":"17ff87c6a0f68ab358c1da489f00e95f1de106fd12ff17d0fb3e210aaa1e5f8c"},"downloads":-1,"filename":"einx-0.3.0.tar.gz","has_sig":false,"md5_digest":"86954b3b50240ab25ba6f891cd9fc310","packagetype":"sdist","python_version":"source","requires_python":">=3.8","size":84758,"upload_time":"2024-06-11T13:49:37","upload_time_iso_8601":"2024-06-11T13:49:37.532515Z","url":"https://files.pythonhosted.org/packages/95/af/2a2f83f981e969ae3ec5dc30f9b0cd1a258acabc2ff7b33eb9726e334e55/einx-0.3.0.tar.gz","yanked":false,"yanked_reason":null}],"vulnerabilities":[]}
