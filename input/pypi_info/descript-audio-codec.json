{"info":{"author":"Prem Seetharaman, Rithesh Kumar","author_email":"prem@descript.com","bugtrack_url":null,"classifiers":["Intended Audience :: Developers","Natural Language :: English","Programming Language :: Python :: 3.7","Topic :: Artistic Software","Topic :: Multimedia","Topic :: Multimedia :: Sound/Audio","Topic :: Multimedia :: Sound/Audio :: Editors","Topic :: Software Development :: Libraries"],"description":"# Descript Audio Codec (.dac): High-Fidelity Audio Compression with Improved RVQGAN\n\nThis repository contains training and inference scripts\nfor the Descript Audio Codec (.dac), a high fidelity general\nneural audio codec, introduced in the paper titled **High-Fidelity Audio Compression with Improved RVQGAN**.\n\n![](https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-16x16.png) [arXiv Paper: High-Fidelity Audio Compression with Improved RVQGAN\n](http://arxiv.org/abs/2306.06546) <br>\nðŸ“ˆ [Demo Site](https://descript.notion.site/Descript-Audio-Codec-11389fce0ce2419891d6591a68f814d5)<br>\nâš™ [Model Weights](https://github.com/descriptinc/descript-audio-codec/releases/download/0.0.1/weights.pth)\n\nðŸ‘‰ With Descript Audio Codec, you can compress **44.1 KHz audio** into discrete codes at a **low 8 kbps bitrate**.  <br>\nðŸ¤Œ That's approximately **90x compression** while maintaining exceptional fidelity and minimizing artifacts.  <br>\nðŸ’ª Our universal model works on all domains (speech, environment, music, etc.), making it widely applicable to generative modeling of all audio.  <br>\nðŸ‘Œ It can be used as a drop-in replacement for EnCodec for all audio language modeling applications (such as AudioLMs, MusicLMs, MusicGen, etc.) <br>\n\n<p align=\"center\">\n<img src=\"./assets/comparsion_stats.png\" alt=\"Comparison of compressions approaches. Our model achieves a higher compression factor compared to all baseline methods. Our model has a ~90x compression factor compared to 32x compression factor of EnCodec and 64x of SoundStream. Note that we operate at a target bitrate of 8 kbps, whereas EnCodec operates at 24 kbps and SoundStream at 6 kbps. We also operate at 44.1 kHz, whereas EnCodec operates at 48 kHz and SoundStream operates at 24 kHz.\" width=35%></p>\n\n\n## Usage\n\n### Installation\n```\npip install descript-audio-codec\n```\nOR\n\n```\npip install git+https://github.com/descriptinc/descript-audio-codec\n```\n\n### Weights\nWeights are released as part of this repo under MIT license.\nWe release weights for models that can natively support 16 kHz, 24kHz, and 44.1kHz sampling rates.\nWeights are automatically downloaded when you first run `encode` or `decode` command. You can cache them using one of the following commands\n```bash\npython3 -m dac download # downloads the default 44kHz variant\npython3 -m dac download --model_type 44khz # downloads the 44kHz variant\npython3 -m dac download --model_type 24khz # downloads the 24kHz variant\npython3 -m dac download --model_type 16khz # downloads the 16kHz variant\n```\nWe provide a Dockerfile that installs all required dependencies for encoding and decoding. The build process caches the default model weights inside the image. This allows the image to be used without an internet connection. [Please refer to instructions below.](#docker-image)\n\n\n### Compress audio\n```\npython3 -m dac encode /path/to/input --output /path/to/output/codes\n```\n\nThis command will create `.dac` files with the same name as the input files.\nIt will also preserve the directory structure relative to input root and\nre-create it in the output directory. Please use `python -m dac encode --help`\nfor more options.\n\n### Reconstruct audio from compressed codes\n```\npython3 -m dac decode /path/to/output/codes --output /path/to/reconstructed_input\n```\n\nThis command will create `.wav` files with the same name as the input files.\nIt will also preserve the directory structure relative to input root and\nre-create it in the output directory. Please use `python -m dac decode --help`\nfor more options.\n\n### Programmatic Usage\n```py\nimport dac\nfrom audiotools import AudioSignal\n\n# Download a model\nmodel_path = dac.utils.download(model_type=\"44khz\")\nmodel = dac.DAC.load(model_path)\n\nmodel.to('cuda')\n\n# Load audio signal file\nsignal = AudioSignal('input.wav')\n\n# Encode audio signal as one long file\n# (may run out of GPU memory on long files)\nsignal.to(model.device)\n\nx = model.preprocess(signal.audio_data, signal.sample_rate)\nz, codes, latents, _, _ = model.encode(x)\n\n# Decode audio signal\ny = model.decode(z)\n\n# Alternatively, use the `compress` and `decompress` functions\n# to compress long files.\n\nsignal = signal.cpu()\nx = model.compress(signal)\n\n# Save and load to and from disk\nx.save(\"compressed.dac\")\nx = dac.DACFile.load(\"compressed.dac\")\n\n# Decompress it back to an AudioSignal\ny = model.decompress(x)\n\n# Write to file\ny.write('output.wav')\n```\n\n### Docker image\nWe provide a dockerfile to build a docker image with all the necessary\ndependencies.\n1. Building the image.\n    ```\n    docker build -t dac .\n    ```\n2. Using the image.\n\n    Usage on CPU:\n    ```\n    docker run dac <command>\n    ```\n\n    Usage on GPU:\n    ```\n    docker run --gpus=all dac <command>\n    ```\n\n    `<command>` can be one of the compression and reconstruction commands listed\n    above. For example, if you want to run compression,\n\n    ```\n    docker run --gpus=all dac python3 -m dac encode ...\n    ```\n\n\n## Training\nThe baseline model configuration can be trained using the following commands.\n\n### Pre-requisites\nPlease install the correct dependencies\n```\npip install -e \".[dev]\"\n```\n\n## Environment setup\n\nWe have provided a Dockerfile and docker compose setup that makes running experiments easy.\n\nTo build the docker image do:\n\n```\ndocker compose build\n```\n\nThen, to launch a container, do:\n\n```\ndocker compose run -p 8888:8888 -p 6006:6006 dev\n```\n\nThe port arguments (`-p`) are optional, but useful if you want to launch a Jupyter and Tensorboard instances within the container. The\ndefault password for Jupyter is `password`, and the current directory\nis mounted to `/u/home/src`, which also becomes the working directory.\n\nThen, run your training command.\n\n\n### Single GPU training\n```\nexport CUDA_VISIBLE_DEVICES=0\npython scripts/train.py --args.load conf/ablations/baseline.yml --save_path runs/baseline/\n```\n\n### Multi GPU training\n```\nexport CUDA_VISIBLE_DEVICES=0,1\ntorchrun --nproc_per_node gpu scripts/train.py --args.load conf/ablations/baseline.yml --save_path runs/baseline/\n```\n\n## Testing\nWe provide two test scripts to test CLI + training functionality. Please\nmake sure that the trainig pre-requisites are satisfied before launching these\ntests. To launch these tests please run\n```\npython -m pytest tests\n```\n\n## Results\n\n<p align=\"left\">\n<img src=\"./assets/objective_comparisons.png\" width=75%></p>\n","description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"https://github.com/descriptinc/descript-audio-codec","keywords":"audio,compression,machine learning","license":"MIT","maintainer":"","maintainer_email":"","name":"descript-audio-codec","package_url":"https://pypi.org/project/descript-audio-codec/","platform":null,"project_url":"https://pypi.org/project/descript-audio-codec/","project_urls":{"Homepage":"https://github.com/descriptinc/descript-audio-codec"},"provides_extra":null,"release_url":"https://pypi.org/project/descript-audio-codec/1.0.0/","requires_dist":["argbind (>=0.3.7)","descript-audiotools (>=0.7.2)","einops","numpy","torch","torchaudio","tqdm","pytest ; extra == 'dev'","pytest-cov ; extra == 'dev'","pynvml ; extra == 'dev'","psutil ; extra == 'dev'","pandas ; extra == 'dev'","onnx ; extra == 'dev'","onnx-simplifier ; extra == 'dev'","seaborn ; extra == 'dev'","jupyterlab ; extra == 'dev'","watchdog ; extra == 'dev'","pesq ; extra == 'dev'","tabulate ; extra == 'dev'","encodec ; extra == 'dev'"],"requires_python":"","summary":"A high-quality general neural audio codec.","version":"1.0.0","yanked":false,"yanked_reason":null},"last_serial":18970572,"releases":{"0.0.2":[{"comment_text":"","digests":{"blake2b_256":"915e98ddbd758c48c098ebfac1238c062941cdce0f53d44db5e9d308c843eae5","md5":"f63c5f7da7520f88af6168a69e3e4778","sha256":"f89f4045a495380f6a24802ed8687f39aa1122343198a07c2e7582f78a786797"},"downloads":-1,"filename":"descript_audio_codec-0.0.2-py3-none-any.whl","has_sig":false,"md5_digest":"f63c5f7da7520f88af6168a69e3e4778","packagetype":"bdist_wheel","python_version":"py3","requires_python":null,"size":25221,"upload_time":"2023-06-14T20:32:43","upload_time_iso_8601":"2023-06-14T20:32:43.507452Z","url":"https://files.pythonhosted.org/packages/91/5e/98ddbd758c48c098ebfac1238c062941cdce0f53d44db5e9d308c843eae5/descript_audio_codec-0.0.2-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"cf54ca8b9f22b17b695d03accb51ec43032c21cbaca18bc7d014a1f35ede5d0a","md5":"87733bb3eee3423aa0ec1b36c5a4a40b","sha256":"fecdccdd2eb91aa451677d51f62e7f64c07b59f9b8e729fa78422c6613d4ade0"},"downloads":-1,"filename":"descript-audio-codec-0.0.2.tar.gz","has_sig":false,"md5_digest":"87733bb3eee3423aa0ec1b36c5a4a40b","packagetype":"sdist","python_version":"source","requires_python":null,"size":21658,"upload_time":"2023-06-14T20:32:45","upload_time_iso_8601":"2023-06-14T20:32:45.283395Z","url":"https://files.pythonhosted.org/packages/cf/54/ca8b9f22b17b695d03accb51ec43032c21cbaca18bc7d014a1f35ede5d0a/descript-audio-codec-0.0.2.tar.gz","yanked":false,"yanked_reason":null}],"0.0.3":[{"comment_text":"","digests":{"blake2b_256":"8d9ee677a5fcb60163537aded868c6297d5dfa571b8c944b852800927c3a5d93","md5":"e082acb2e19ef9f8c93b4fe31c69ca3a","sha256":"b1acec1e7742e3ff16332c9bf94eceeabe361b7caf7b0229316510674b4f1d83"},"downloads":-1,"filename":"descript_audio_codec-0.0.3-py3-none-any.whl","has_sig":false,"md5_digest":"e082acb2e19ef9f8c93b4fe31c69ca3a","packagetype":"bdist_wheel","python_version":"py3","requires_python":null,"size":25455,"upload_time":"2023-06-19T19:32:21","upload_time_iso_8601":"2023-06-19T19:32:21.782737Z","url":"https://files.pythonhosted.org/packages/8d/9e/e677a5fcb60163537aded868c6297d5dfa571b8c944b852800927c3a5d93/descript_audio_codec-0.0.3-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"dd77a7a3b3a7cb9aad8f8d4565f9b0b50a1dcb839a7be67e7ca8075a4966000d","md5":"e5b7d6f91207ad2b26537c38b2c3cae3","sha256":"2c1bb6631ec3219f22220505ac2101514442a5615d63c7021b258d46f15da1ce"},"downloads":-1,"filename":"descript-audio-codec-0.0.3.tar.gz","has_sig":false,"md5_digest":"e5b7d6f91207ad2b26537c38b2c3cae3","packagetype":"sdist","python_version":"source","requires_python":null,"size":21893,"upload_time":"2023-06-19T19:32:23","upload_time_iso_8601":"2023-06-19T19:32:23.778256Z","url":"https://files.pythonhosted.org/packages/dd/77/a7a3b3a7cb9aad8f8d4565f9b0b50a1dcb839a7be67e7ca8075a4966000d/descript-audio-codec-0.0.3.tar.gz","yanked":false,"yanked_reason":null}],"0.0.4":[{"comment_text":"","digests":{"blake2b_256":"cc217575a4b14da01a33daff074663a0ba36b798aed7912d1507a8788719d4e0","md5":"39d0cc7c5510e078858c89a4b4d24282","sha256":"a4cdb02d0ee4b7357b73f2beffccda582e8649d19b2cac5759df8c3ee20eeb71"},"downloads":-1,"filename":"descript_audio_codec-0.0.4-py3-none-any.whl","has_sig":false,"md5_digest":"39d0cc7c5510e078858c89a4b4d24282","packagetype":"bdist_wheel","python_version":"py3","requires_python":null,"size":26659,"upload_time":"2023-06-21T17:49:35","upload_time_iso_8601":"2023-06-21T17:49:35.156864Z","url":"https://files.pythonhosted.org/packages/cc/21/7575a4b14da01a33daff074663a0ba36b798aed7912d1507a8788719d4e0/descript_audio_codec-0.0.4-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"0a6803b18353eee978921c8d6ebcbb42d16781d04ac70448ac7a040c50e3098b","md5":"52553dd1418e8b5873cf58a9264ad924","sha256":"b1b2fc0a3d85ba474318740c7d95858d421d1d5395d8bd4a8d3aaa3fe30f90a0"},"downloads":-1,"filename":"descript-audio-codec-0.0.4.tar.gz","has_sig":false,"md5_digest":"52553dd1418e8b5873cf58a9264ad924","packagetype":"sdist","python_version":"source","requires_python":null,"size":22776,"upload_time":"2023-06-21T17:49:36","upload_time_iso_8601":"2023-06-21T17:49:36.340080Z","url":"https://files.pythonhosted.org/packages/0a/68/03b18353eee978921c8d6ebcbb42d16781d04ac70448ac7a040c50e3098b/descript-audio-codec-0.0.4.tar.gz","yanked":false,"yanked_reason":null}],"0.0.5":[{"comment_text":"","digests":{"blake2b_256":"881a8451f9fcf58a26685461d354af0448519efcd2ced1db05a01113376209eb","md5":"8e466a81a1f1a275c4aa67a7122e66d2","sha256":"e5b7dfd3d9ae5e88188c84896070eae043fddd5cca5510b06cd39eb30775a82a"},"downloads":-1,"filename":"descript_audio_codec-0.0.5-py3-none-any.whl","has_sig":false,"md5_digest":"8e466a81a1f1a275c4aa67a7122e66d2","packagetype":"bdist_wheel","python_version":"py3","requires_python":null,"size":26725,"upload_time":"2023-07-05T16:00:11","upload_time_iso_8601":"2023-07-05T16:00:11.596204Z","url":"https://files.pythonhosted.org/packages/88/1a/8451f9fcf58a26685461d354af0448519efcd2ced1db05a01113376209eb/descript_audio_codec-0.0.5-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"616513f152b3b546b072b152eca8d1f9ba192c03771f8b01c96c0b9ac0461048","md5":"74b242860f49c62de05476af4c31f9d2","sha256":"ddbbed2efeb256558d169f0aaf0119a47908845313209b54f966b81b17e97848"},"downloads":-1,"filename":"descript-audio-codec-0.0.5.tar.gz","has_sig":false,"md5_digest":"74b242860f49c62de05476af4c31f9d2","packagetype":"sdist","python_version":"source","requires_python":null,"size":22833,"upload_time":"2023-07-05T16:00:13","upload_time_iso_8601":"2023-07-05T16:00:13.101566Z","url":"https://files.pythonhosted.org/packages/61/65/13f152b3b546b072b152eca8d1f9ba192c03771f8b01c96c0b9ac0461048/descript-audio-codec-0.0.5.tar.gz","yanked":false,"yanked_reason":null}],"1.0.0":[{"comment_text":"","digests":{"blake2b_256":"6ec493f7309eb40a9299c59a6637f13c21b08e585c569fee85901ccd55ce00f5","md5":"412f779114f718509bd08a43358e7953","sha256":"7ecd1883040613d143494f27f199c11c7053a8a7f9fd2120568c5a98db926e61"},"downloads":-1,"filename":"descript_audio_codec-1.0.0-py3-none-any.whl","has_sig":false,"md5_digest":"412f779114f718509bd08a43358e7953","packagetype":"bdist_wheel","python_version":"py3","requires_python":null,"size":26933,"upload_time":"2023-07-20T18:10:29","upload_time_iso_8601":"2023-07-20T18:10:29.436859Z","url":"https://files.pythonhosted.org/packages/6e/c4/93f7309eb40a9299c59a6637f13c21b08e585c569fee85901ccd55ce00f5/descript_audio_codec-1.0.0-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"7b89022d30f42091b0228f24449d0083130d44a1f6d141ad67f2cc67e22679d2","md5":"8193db3047342100633d6edbcf0134ea","sha256":"56a5a541128686821570756512d405534e9d7a978b34adf2510cfe981f0b00e0"},"downloads":-1,"filename":"descript-audio-codec-1.0.0.tar.gz","has_sig":false,"md5_digest":"8193db3047342100633d6edbcf0134ea","packagetype":"sdist","python_version":"source","requires_python":null,"size":23711,"upload_time":"2023-07-20T18:10:30","upload_time_iso_8601":"2023-07-20T18:10:30.913612Z","url":"https://files.pythonhosted.org/packages/7b/89/022d30f42091b0228f24449d0083130d44a1f6d141ad67f2cc67e22679d2/descript-audio-codec-1.0.0.tar.gz","yanked":false,"yanked_reason":null}]},"urls":[{"comment_text":"","digests":{"blake2b_256":"6ec493f7309eb40a9299c59a6637f13c21b08e585c569fee85901ccd55ce00f5","md5":"412f779114f718509bd08a43358e7953","sha256":"7ecd1883040613d143494f27f199c11c7053a8a7f9fd2120568c5a98db926e61"},"downloads":-1,"filename":"descript_audio_codec-1.0.0-py3-none-any.whl","has_sig":false,"md5_digest":"412f779114f718509bd08a43358e7953","packagetype":"bdist_wheel","python_version":"py3","requires_python":null,"size":26933,"upload_time":"2023-07-20T18:10:29","upload_time_iso_8601":"2023-07-20T18:10:29.436859Z","url":"https://files.pythonhosted.org/packages/6e/c4/93f7309eb40a9299c59a6637f13c21b08e585c569fee85901ccd55ce00f5/descript_audio_codec-1.0.0-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"7b89022d30f42091b0228f24449d0083130d44a1f6d141ad67f2cc67e22679d2","md5":"8193db3047342100633d6edbcf0134ea","sha256":"56a5a541128686821570756512d405534e9d7a978b34adf2510cfe981f0b00e0"},"downloads":-1,"filename":"descript-audio-codec-1.0.0.tar.gz","has_sig":false,"md5_digest":"8193db3047342100633d6edbcf0134ea","packagetype":"sdist","python_version":"source","requires_python":null,"size":23711,"upload_time":"2023-07-20T18:10:30","upload_time_iso_8601":"2023-07-20T18:10:30.913612Z","url":"https://files.pythonhosted.org/packages/7b/89/022d30f42091b0228f24449d0083130d44a1f6d141ad67f2cc67e22679d2/descript-audio-codec-1.0.0.tar.gz","yanked":false,"yanked_reason":null}],"vulnerabilities":[]}
