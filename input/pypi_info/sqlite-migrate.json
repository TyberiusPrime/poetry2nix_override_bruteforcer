{"info":{"author":"Simon Willison","author_email":"","bugtrack_url":null,"classifiers":["Development Status :: 2 - Pre-Alpha"],"description":"# sqlite-migrate\n\n[![PyPI](https://img.shields.io/pypi/v/sqlite-migrate.svg)](https://pypi.org/project/sqlite-migrate/)\n[![Changelog](https://img.shields.io/github/v/release/simonw/sqlite-migrate?include_prereleases&label=changelog)](https://sqlite-migrate.datasette.io/en/stable/changelog.html)\n[![Tests](https://github.com/simonw/sqlite-migrate/workflows/Test/badge.svg)](https://github.com/simonw/sqlite-migrate/actions?query=workflow%3ATest)\n[![License](https://img.shields.io/badge/license-Apache%202.0-blue.svg)](https://github.com/simonw/sqlite-migrate/blob/main/LICENSE)\n\nA simple database migration system for SQLite, based on [sqlite-utils](https://sqlite-utils.datasette.io/).\n\n**This project is an early alpha. Expect breaking changes.**\n\n## Installation\n\nThis tool works as a plugin for `sqlite-utils`. First [install that](https://sqlite-utils.datasette.io/en/stable/installation.html):\n\n```bash\npip install sqlite-utils\n```\nThen install this plugin like so:\n```bash\nsqlite-utils install sqlite-migrate\n```\n## Migration files\n\nThis tool works against migration files. A migration file looks like this:\n\n```python\nfrom sqlite_migrate import Migrations\n\n# Pick a unique name here - it must not clash with other migration sets that\n# the user might run against the same database.\n\nmigration = Migrations(\"creatures\")\n\n# Use this decorator against functions that implement migrations\n@migration()\ndef m001_create_table(db):\n    # db is a sqlite-utils Database instance\n    db[\"creatures\"].create(\n        {\"id\": int, \"name\": str, \"species\": str},\n        pk=\"id\"\n    )\n\n@migration()\ndef m002_add_weight(db):\n    # db is a sqlite-utils Database instance\n    db[\"creatures\"].add_column(\"weight\", float)\n```\nHere is [documentation on the Database instance](https://sqlite-utils.datasette.io/en/stable/python-api.html) passed to each migration function.\n\n## Running migrations\n\nRunning this command will execute those migrations in sequence against the specified database file.\n\nCall `migrate` with a path to your database and a path to the migrations file you want to apply:\n```bash\nsqlite-utils migrate creatures.db path/to/migrations.py\n```\nRunning this multiple times will have no additional affect, unless you add more migration functions to the file.\n\nIf you call it without arguments it will search for and apply any `migrations.py` files in the current directory or any of its subdirectories.\n\nYou can also pass the path to a directory, in which case all `migrations.py` files in that directory and its subdirectories will be applied:\n\n```bash\nsqlite-utils migrate creatures.db path/to/parent/\n```\nWhen applying a single migrations file you can use the `--stop-before` option to apply all migrations up to but excluding the specified migration:\n\n```bash\nsqlite-utils migrate creatures.db path/to/migrations.py --stop-before m002_add_weight\n```\n\n## Listing migrations\n\nAdd `--list` to list migrations without running them, for example:\n\n```bash\nsqlite-utils migrate creatures.db --list\n```\nThe output will look something like this:\n```\nMigrations for: creatures\n\n  Applied:\n    m001_create_table - 2023-07-23 04:09:40.324002\n    m002_add_weight - 2023-07-23 04:09:40.324649\n    m003_add_age - 2023-07-23 04:09:44.441616\n    m003_cleanup - 2023-07-23 04:09:44.443394\n    m004_cleanup - 2023-07-23 04:09:44.444184\n    m005_cleanup - 2023-07-23 04:09:44.445389\n    m006_cleanup - 2023-07-23 04:09:44.446742\n    m007_cleanup - 2023-07-23 04:16:02.529983\n\n  Pending:\n    m008_cleanup\n```\n\n## Verbose mode\n\nAdd `-v` or `--verbose` for verbose output, which will show the schema before and after the migrations were applied along with a diff:\n\n```bash\nsqlite-utils migrate creatures.db --verbose\n```\nExample output:\n```\nMigrating creatures.db\n\nSchema before:\n\n  CREATE TABLE \"_sqlite_migrations\" (\n     [migration_set] TEXT,\n     [name] TEXT,\n     [applied_at] TEXT,\n     PRIMARY KEY ([migration_set], [name])\n  );\n  CREATE TABLE [creatures] (\n     [id] INTEGER PRIMARY KEY,\n     [name] TEXT,\n     [species] TEXT\n  , [weight] FLOAT);\n\nSchema after:\n\n  CREATE TABLE \"_sqlite_migrations\" (\n     [migration_set] TEXT,\n     [name] TEXT,\n     [applied_at] TEXT,\n     PRIMARY KEY ([migration_set], [name])\n  );\n  CREATE TABLE \"creatures\" (\n     [id] INTEGER PRIMARY KEY,\n     [name] TEXT,\n     [species] TEXT,\n     [weight] FLOAT,\n     [age] INTEGER,\n     [shoe_size] INTEGER\n  );\n\nSchema diff:\n\n    [applied_at] TEXT,\n    PRIMARY KEY ([migration_set], [name])\n  );\n-CREATE TABLE [creatures] (\n+CREATE TABLE \"creatures\" (\n    [id] INTEGER PRIMARY KEY,\n    [name] TEXT,\n-   [species] TEXT\n-, [weight] FLOAT);\n+   [species] TEXT,\n+   [weight] FLOAT,\n+   [age] INTEGER,\n+   [shoe_size] INTEGER\n+);\n```\n","description_content_type":"text/markdown","docs_url":null,"download_url":"","downloads":{"last_day":-1,"last_month":-1,"last_week":-1},"dynamic":null,"home_page":"","keywords":"","license":"Apache-2.0","maintainer":"","maintainer_email":"","name":"sqlite-migrate","package_url":"https://pypi.org/project/sqlite-migrate/","platform":null,"project_url":"https://pypi.org/project/sqlite-migrate/","project_urls":{"Changelog":"https://github.com/simonw/sqlite-migrate/releases","Homepage":"https://github.com/simonw/sqlite-migrate","Issues":"https://github.com/simonw/sqlite-migrate/issues"},"provides_extra":null,"release_url":"https://pypi.org/project/sqlite-migrate/0.1b0/","requires_dist":["sqlite-utils","pytest ; extra == 'test'","mypy ; extra == 'test'","black ; extra == 'test'","ruff ; extra == 'test'"],"requires_python":"","summary":"A simple database migration system for SQLite, based on sqlite-utils","version":"0.1b0","yanked":false,"yanked_reason":null},"last_serial":20369862,"releases":{"0.1a0":[{"comment_text":"","digests":{"blake2b_256":"33b12c8991da271d0dcb05ceafb079ab90540c5b4d39c070328f64e0893a0f09","md5":"6115f143f03d86327527824b8c460546","sha256":"a79cd1472a806a5edf15b10d32477c25e55e8d123e5ee13d741fb88cb8b528a4"},"downloads":-1,"filename":"sqlite_migrate-0.1a0-py3-none-any.whl","has_sig":false,"md5_digest":"6115f143f03d86327527824b8c460546","packagetype":"bdist_wheel","python_version":"py3","requires_python":null,"size":8242,"upload_time":"2023-07-23T01:31:59","upload_time_iso_8601":"2023-07-23T01:31:59.062763Z","url":"https://files.pythonhosted.org/packages/33/b1/2c8991da271d0dcb05ceafb079ab90540c5b4d39c070328f64e0893a0f09/sqlite_migrate-0.1a0-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"1e0a469d068c3c35bcff904024a1f9c696d7dcfe066367d31023a86f6f4a3f01","md5":"0ed58bdcf0fe36743e2906e62f1ed463","sha256":"85f5c889034965aa6b12c2cb736e61b4cf0e9b5f98e09c04e01df9ac53674322"},"downloads":-1,"filename":"sqlite-migrate-0.1a0.tar.gz","has_sig":false,"md5_digest":"0ed58bdcf0fe36743e2906e62f1ed463","packagetype":"sdist","python_version":"source","requires_python":null,"size":7968,"upload_time":"2023-07-23T01:32:00","upload_time_iso_8601":"2023-07-23T01:32:00.954189Z","url":"https://files.pythonhosted.org/packages/1e/0a/469d068c3c35bcff904024a1f9c696d7dcfe066367d31023a86f6f4a3f01/sqlite-migrate-0.1a0.tar.gz","yanked":false,"yanked_reason":null}],"0.1a1":[{"comment_text":"","digests":{"blake2b_256":"904cf5f33896fe3c590760a4bb4a57e9887a0a0bf56b89e9d56c03c777243d0d","md5":"c537cae776e031fb7b4c5d674c24f527","sha256":"f89e3c7053ac40e2ce7e4d029144ca570c96a364bb0afbb4a66275513ae7e6e3"},"downloads":-1,"filename":"sqlite_migrate-0.1a1-py3-none-any.whl","has_sig":false,"md5_digest":"c537cae776e031fb7b4c5d674c24f527","packagetype":"bdist_wheel","python_version":"py3","requires_python":null,"size":9687,"upload_time":"2023-07-23T04:26:49","upload_time_iso_8601":"2023-07-23T04:26:49.718442Z","url":"https://files.pythonhosted.org/packages/90/4c/f5f33896fe3c590760a4bb4a57e9887a0a0bf56b89e9d56c03c777243d0d/sqlite_migrate-0.1a1-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"62c900f0c21f10d2799336a793779c46c1e39a1e6b28e34cbdf85ac3d70b3f30","md5":"bf7cd777ba8bffd71296aaafba35645f","sha256":"5c37a63fd83c561f9f7a5d2cd71072fd00efd6b87839060b7437c9dc57b79a25"},"downloads":-1,"filename":"sqlite-migrate-0.1a1.tar.gz","has_sig":false,"md5_digest":"bf7cd777ba8bffd71296aaafba35645f","packagetype":"sdist","python_version":"source","requires_python":null,"size":9821,"upload_time":"2023-07-23T04:26:50","upload_time_iso_8601":"2023-07-23T04:26:50.887001Z","url":"https://files.pythonhosted.org/packages/62/c9/00f0c21f10d2799336a793779c46c1e39a1e6b28e34cbdf85ac3d70b3f30/sqlite-migrate-0.1a1.tar.gz","yanked":false,"yanked_reason":null}],"0.1a2":[{"comment_text":"","digests":{"blake2b_256":"befb99d66f9395301a74b15e7449b425480164385e1267027040ebbedf1f8643","md5":"4c70536ecdf5e2ddbfe9bd4b4ccc26c7","sha256":"e4b0bcefdaf8f416ea09344b85773a61834a8a5d003aedde0bed0462311a5465"},"downloads":-1,"filename":"sqlite_migrate-0.1a2-py3-none-any.whl","has_sig":false,"md5_digest":"4c70536ecdf5e2ddbfe9bd4b4ccc26c7","packagetype":"bdist_wheel","python_version":"py3","requires_python":null,"size":9897,"upload_time":"2023-09-03T17:30:00","upload_time_iso_8601":"2023-09-03T17:30:00.926955Z","url":"https://files.pythonhosted.org/packages/be/fb/99d66f9395301a74b15e7449b425480164385e1267027040ebbedf1f8643/sqlite_migrate-0.1a2-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"9e330b0fc2ac04f91b0cde409ec1a177753a2ff46a7f211116d511dde2e6d2a2","md5":"a85530752ee947a4a63e4cf425cfef8b","sha256":"c33b40a9edd35b4490e095f55cf59e03828d25c8b97377cd8a1f7b72694fc111"},"downloads":-1,"filename":"sqlite-migrate-0.1a2.tar.gz","has_sig":false,"md5_digest":"a85530752ee947a4a63e4cf425cfef8b","packagetype":"sdist","python_version":"source","requires_python":null,"size":10398,"upload_time":"2023-09-03T17:30:03","upload_time_iso_8601":"2023-09-03T17:30:03.231465Z","url":"https://files.pythonhosted.org/packages/9e/33/0b0fc2ac04f91b0cde409ec1a177753a2ff46a7f211116d511dde2e6d2a2/sqlite-migrate-0.1a2.tar.gz","yanked":false,"yanked_reason":null}],"0.1b0":[{"comment_text":"","digests":{"blake2b_256":"df92994545b912e6d6feb40323047f02ca039321e690aa2c27afcd5c4105e37b","md5":"6c96c7bacf8b84c9b241432ce60f978d","sha256":"a4125e35e1de3dc56b6b6ec60e9833ce0ce20192b929ddcb2d4246c5098859c6"},"downloads":-1,"filename":"sqlite_migrate-0.1b0-py3-none-any.whl","has_sig":false,"md5_digest":"6c96c7bacf8b84c9b241432ce60f978d","packagetype":"bdist_wheel","python_version":"py3","requires_python":null,"size":9986,"upload_time":"2023-10-27T23:47:42","upload_time_iso_8601":"2023-10-27T23:47:42.476768Z","url":"https://files.pythonhosted.org/packages/df/92/994545b912e6d6feb40323047f02ca039321e690aa2c27afcd5c4105e37b/sqlite_migrate-0.1b0-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"13861463a00d3c4bdb707c0ed4077d17687465a0aa9444593f66f6c4b49e39b5","md5":"d904e85ee8a035b4d0848ad38115b3a6","sha256":"8d502b3ca4b9c45e56012bd35c03d23235f0823c976d4ce940cbb40e33087ded"},"downloads":-1,"filename":"sqlite-migrate-0.1b0.tar.gz","has_sig":false,"md5_digest":"d904e85ee8a035b4d0848ad38115b3a6","packagetype":"sdist","python_version":"source","requires_python":null,"size":10736,"upload_time":"2023-10-27T23:47:43","upload_time_iso_8601":"2023-10-27T23:47:43.855353Z","url":"https://files.pythonhosted.org/packages/13/86/1463a00d3c4bdb707c0ed4077d17687465a0aa9444593f66f6c4b49e39b5/sqlite-migrate-0.1b0.tar.gz","yanked":false,"yanked_reason":null}]},"urls":[{"comment_text":"","digests":{"blake2b_256":"df92994545b912e6d6feb40323047f02ca039321e690aa2c27afcd5c4105e37b","md5":"6c96c7bacf8b84c9b241432ce60f978d","sha256":"a4125e35e1de3dc56b6b6ec60e9833ce0ce20192b929ddcb2d4246c5098859c6"},"downloads":-1,"filename":"sqlite_migrate-0.1b0-py3-none-any.whl","has_sig":false,"md5_digest":"6c96c7bacf8b84c9b241432ce60f978d","packagetype":"bdist_wheel","python_version":"py3","requires_python":null,"size":9986,"upload_time":"2023-10-27T23:47:42","upload_time_iso_8601":"2023-10-27T23:47:42.476768Z","url":"https://files.pythonhosted.org/packages/df/92/994545b912e6d6feb40323047f02ca039321e690aa2c27afcd5c4105e37b/sqlite_migrate-0.1b0-py3-none-any.whl","yanked":false,"yanked_reason":null},{"comment_text":"","digests":{"blake2b_256":"13861463a00d3c4bdb707c0ed4077d17687465a0aa9444593f66f6c4b49e39b5","md5":"d904e85ee8a035b4d0848ad38115b3a6","sha256":"8d502b3ca4b9c45e56012bd35c03d23235f0823c976d4ce940cbb40e33087ded"},"downloads":-1,"filename":"sqlite-migrate-0.1b0.tar.gz","has_sig":false,"md5_digest":"d904e85ee8a035b4d0848ad38115b3a6","packagetype":"sdist","python_version":"source","requires_python":null,"size":10736,"upload_time":"2023-10-27T23:47:43","upload_time_iso_8601":"2023-10-27T23:47:43.855353Z","url":"https://files.pythonhosted.org/packages/13/86/1463a00d3c4bdb707c0ed4077d17687465a0aa9444593f66f6c4b49e39b5/sqlite-migrate-0.1b0.tar.gz","yanked":false,"yanked_reason":null}],"vulnerabilities":[]}
